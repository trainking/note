# MongoDB最佳实践

## 复制集

MongoDB使用**复制集**实现高可用机制。MongoDB中的复制集（Replica Set）是一组MongoDB实例的集合，用于提供数据冗余和高可用性。复制集中包含一个主节点（Primary）和多个从节点（Secondary），主节点处理所有写操作，并将数据同步到从节点，从节点只能读取数据。如果主节点出现故障或不可用，复制集会自动选择一个从节点作为新的主节点，以保证系统的可用性和数据完整性。

**复制集**通过选举完成故障恢复。它有以下特点：

* 具有投票权的的节点之间互相发送心跳（保活）
* 当5次心跳未收到时判断为失联节点
* 如果失联的主节点，从节点会发起选举，选出新的主节点
* 如果失联的时从节点，不会重新产生选举
* 选举基于RAFT一致性算法实现，选举成功的必要条件时大多数投票节点存活
* 复制集最多可以有50个，但具有投票权的最多7个